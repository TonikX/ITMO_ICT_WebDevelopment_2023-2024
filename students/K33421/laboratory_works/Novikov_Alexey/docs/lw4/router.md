# Роутер

Все компоненты написаны, теперь нужно понять, в какой момент какой компонент выводить пользователю, для этого воспользуемся 
роутером.

```js title="helpers/router.js"
--8<-- "laboratory_work_4/src/helpers/router.js"
```

Здесь в `routes` мы объявим наши маршруты и укажем, какой основной компонент выводить, с какими пропами и с какими дочерними 
компонентами.

В нашем приложении будет только три маршрута, в соответствии с количеством представлений 
(которые мы и будем передавать как дочерние компоненты).

Для каждого маршрута основным компонентом будет являться макет `Default`, для которого нужно в пропах указать, что нужно отображать.

Помимо объявления маршрутов здесь нам также нужно вызвать функцию роутера `beforeEach`, которая перед перенаправлением пользователя 
на нужный маршрут выполнит необходимые для нас действия, которые в итоге могут изменить маршрут.

В ней мы укажем страницу `/login` как доступную без авторизации, а остальные - только с авторизацией.

Если пользователь без авторизации попытается перейти на любую страницу, отличную от `/login`, будем перенаправлять его на авторизацию.  
И наоборот, если авторизованный пользователь решит перейти на страницу авторизации, перенаправим его на страницу прохождения опроса.

Если пользователь переход на страницу прохождения опроса, нужно проверить, может ли этот пользователь его проходить.

Для этого отправим запрос на бэкенд и запросим статусы пользователя. Пройдём через каждый из них и при несоблюдении обновим 
текст в хранилище на соответствующий и переведём его на информационную страницу.

Если все условия соблюдены, позволим перейти на страницу опроса.

Кроме того, нам также нужно проверять эти условия и на информационной странице, чтобы в случае изменения информации в БД 
или в случае исправления ошибки пользователь при обновлении страницы был переведён на страницу опроса.

Чтобы не происходило две проверки подряд, будем хранить в переменной `lastCheckFetchWasFrom` маршрут страницы, с которой 
в последний раз была запущена проверка, и не будем повторно запускать проверку при перенаправлении со страницы опроса на 
информационную страницу.